<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Qu√™te des Stands ‚Äì Point Animations</title>
<style>
body{
  font-family:Arial,sans-serif;
  background:radial-gradient(circle at top,#2a0033,#0b0010);
  color:white;
  text-align:center;
  padding:20px;
}
.box{
  max-width:420px;
  margin:auto;
  background:rgba(0,0,0,0.65);
  padding:22px;
  border-radius:18px;
  box-shadow:0 0 25px rgba(255,95,210,0.25);
}
h1,h2{
  color:#ff5fd2;
  text-shadow:0 0 8px rgba(255,95,210,0.6);
}
.stand-image{
  width:100%;
  max-width:360px;
  margin:15px auto;
  border-radius:14px;
  box-shadow:0 0 20px rgba(255,95,210,0.35);
}
input{
  width:80%;
  padding:10px;
  margin-top:10px;
  border-radius:20px;
  border:none;
  text-align:center;
}
button{
  margin-top:14px;
  padding:12px 22px;
  background:linear-gradient(135deg,#ff5fd2,#b84dff);
  border:none;
  border-radius:30px;
  font-weight:bold;
  color:black;
  cursor:pointer;
}
button:hover{ transform:scale(1.05); }
.success{ color:#6bffb0; margin-top:12px; }
.error{ color:#ff6b6b; margin-top:12px; }
.mission-complete{
  font-size:28px;
  font-weight:bold;
  color:#6bffb0;
  text-shadow:0 0 8px #6bffb0,0 0 16px #6bffb0,0 0 24px #6bffb0;
  animation:pulse 1.2s infinite alternate;
  margin-top:20px;
}
@keyframes pulse{
  from{transform:scale(1);opacity:0.7;}
  to{transform:scale(1.08);opacity:1;}
}
</style>
</head>
<body>
<div class="box">
<h1 id="title">Qu√™te des Stands</h1>
<div id="content"></div>
</div>
<script>
/* ========================= RESET CACH√â ========================= */
const title = document.getElementById("title");
let pressTimer;
title.addEventListener("mousedown",startReset);
title.addEventListener("touchstart",startReset);
title.addEventListener("mouseup",cancelReset);
title.addEventListener("mouseleave",cancelReset);
title.addEventListener("touchend",cancelReset);
function startReset(){
  pressTimer=setTimeout(()=>{
    localStorage.removeItem("progress");
    localStorage.removeItem("startTime");
    alert("Progression r√©initialis√©e");
    location.reload();
  },3000);
}
function cancelReset(){ clearTimeout(pressTimer); }

/* ========================= TIMER MIN 10 MIN ========================= */
const MIN_TIME = 10 * 60 * 1000;
let startTime = localStorage.getItem("startTime");
if(!startTime){
  startTime = Date.now();
  localStorage.setItem("startTime",startTime);
}else{
  startTime = parseInt(startTime);
}

/* ========================= IMAGE ACCUEIL ========================= */
const presentationImage="images/presentation.png";

/* ========================= STANDS ========================= */
const stands=[
{ title:"Point Animations", text:"üé§‚ú® Joue √† la Qu√™te des Stands ! ‚ú®üé§\n\nPars explorer les stands et r√©ponds √† leurs √©nigmes." },
{ title:"Stand L178 ‚Äì United Glowsticks", question:"Mon premier est une plante, mon second est l'argot pour dire v√™tement, mon troisi√®me est le contraire d'amour, mon tout est le petit lapin d'UGS?", answers:["usapen","Usapen", "USAPEN"] },
{ title:"Stand L135 ‚Äì Karat√© Dojo", question:"Combien de m√©dailles nationales a obtenu le Karat√© Dojo Marseillais depuis sa cr√©ation en 2014 ?", answers:["20","vingt", "Vingt"] },
{ title:"Stand J150 ‚Äì ASSL Provence", question:"Quelle est la m√©thode de combat de l'ASSL Provence ?", answers:["combat intuitif","intuitif", "Intuitif", "INTUITIF", "Combat intuitif", "COMBAT INTUITIF", "Combat Intuitif"] },
{ title:"Stand E037 ‚Äì Game Academy", question:"Combien de formations Game Academy propose ?", answers:["6","six","Six", "SIX"] },
{ title:"Stand E182 ‚Äì Animaniak", question:"En quelle ann√©e a √©t√© cr√©√©e l'association Animaniak ?", answers:["2016"] },
{ title:"Stand E198 ‚Äì Chinafi", question:"Quand porte-t-on le yukata ?", answers:["ete","√©t√©", "√©te", "l'√©t√©", "Ete", "√ât√©", "√âte", "L'√©t√©", "ETE", "√âT√â", "√âTE", "L'ETE", "L'√âT√â"] },
{ title:"Stand E192 ‚Äì Chuuren Potos Mahjong", question:"Que repr√©sente le nom du club Churren Potos ?", answers:["Une combinaison du mahjong", "une combinaison du mahjong", "combinaison du mahjong", "combinaison", "mahjong"] },
{ title:"Stand D038 ‚Äì Doud dans le r√©tro", question:"Quelle est la plus ancienne console pr√©sente sur le stand Doud dans le r√©tro ?", answers:["mega drive","sega mega drive", "Mega drive", "Sega mega drive", "Mega Drive", "Sega Mega drive", "Sega Mega Drive", "MEGA DRIVE", "SEGA MEGA DRIVE"] },
{ title:"Stand E195 ‚Äì Sardin Ki'in - Jeu de GO", question:"Dans une partie expos√©e au stand jeu de GO, comptez les points de chacun des joueurs, qui gagne ?", answers:["Blanc", "blanc", "BLANC", "Blancs", "Les blancs", "LES BLANCS", "Les blancs", "Les Blancs", "LES BLANCS"] },
{ title:"Stand E157 ‚Äì Iokai Shiatsu", question:"Que veut dire litt√©ralement shiatsu ?", answers:["Pression des doigts", "pression des doigts", "PRESSION DES DOIGTS", "pression des doigts"] },
{ title:"Stand K150 ‚Äì Forge Je'daii", question:"De quel jeu vid√©o s'inspire la technologie BattleSword pr√©sente sur le stand Forge Je'daii ?", answers:["Street Fighter","Street fighter","STREET FIGHTER", "street fighter"] },
{ title:"Stand E173 ‚Äì K-AMI Origami", question:"Quand est apparu l'origami r√©cr√©atif ?", answers:["17","17e","17eme","xvii", "xviie", "XVII", "XVIIe", "17√®me", "17E", "17EME", "17Eme", "17e si√®cle", "17eme si√®cle", "xviie si√®cle", "XVIIE si√®cle"] }
];

/* ========================= SAUVEGARDE ========================= */
let progress=parseInt(localStorage.getItem("progress"))||0;
let current=progress;
const content=document.getElementById("content");

/* ========================= NORMALISATION ========================= */
function normalize(text){
return text
.toLowerCase()
.normalize("NFD")
.replace(/[\u0300-\u036f]/g,"") // retire accents
.replace(/[^a-z0-9\s]/g,"") // retire ponctuation
.replace(/\s+/g," ") // espaces multiples
.trim();
}
function levenshtein(a, b) {
const matrix = [];
for (let i = 0; i <= b.length; i++) matrix[i] = [i];
for (let j = 0; j <= a.length; j++) matrix[0][j] = j;

for (let i = 1; i <= b.length; i++) {
  for (let j = 1; j <= a.length; j++) {
    if (b[i - 1] === a[j - 1]) {
      matrix[i][j] = matrix[i - 1][j - 1];
    } else {
      matrix[i][j] = Math.min(
        matrix[i - 1][j - 1] + 1,
        matrix[i][j - 1] + 1,
        matrix[i - 1][j] + 1
      );
    }
  }
}
return matrix[b.length][a.length];
}

/* ========================= RENDER ========================= */
function render(){
if(current>=stands.length){
  const elapsed = Date.now() - startTime;
  if(elapsed < MIN_TIME){
    const remaining = Math.ceil((MIN_TIME - elapsed)/60000);
    content.innerHTML = `
<p class="error">
    ‚õî On ne la fait pas √† Chibi Dino, pris la main dans le sac petit tricheur ! üòà<br><br>
    Retourne au Point Animations pour recommencer.<br>
</p>
<img src="images/holmes.png" class="stand-image">
`;
    return;
  }
  content.innerHTML=`
<div class="mission-complete">
  MISSION COMPLETE
</div>
<p class="success">
  üéâ Bravo !<br><br>
  Pr√©sente cet √©cran au staff du Point Animations.
</p>`;
  return;
}
const stand=stands[current];
if(!stand.question){
content.innerHTML=`
<h2>${stand.title}</h2>
<img src="${presentationImage}" class="stand-image">
<p>${stand.text.replace(/\n/g,"<br>")}</p>
<button onclick="next()">Commencer</button>`;
return;
}
content.innerHTML=`
<h2>${stand.title}</h2>
<p>${stand.question}</p>
<input id="answer" placeholder="Ta r√©ponse">
<br>
<button onclick="check()">Valider</button>
<div id="message"></div>`;
}

/* ========================= CHECK ========================= */
function check(){
const answer=document.getElementById("answer");
const message=document.getElementById("message");
const user=normalize(answer.value);

const validAnswers=stands[current].answers.map(a=>normalize(a));

const ok=validAnswers.some(a=>{
  // √©galit√©
  if(user === a) return true;
  // contient
  if(user.includes(a)) return true;
  // tol√©rance fautes (max 2 caract√®res d'erreur)
  if(levenshtein(user,a) <= 2) return true;
  return false;
});

if(ok){
progress=current+1;
localStorage.setItem("progress",progress);
message.innerHTML=`
<p class="success">Bonne r√©ponse !</p>
<button onclick="next()">Continuer ‚ûú</button>`;
}else{
message.innerHTML=`<p class="error">Mauvaise r√©ponse, observe bien le stand üëÄ</p>`;
}
}

/* ========================= NEXT ========================= */
function next(){
current++;
render();
}

/* ========================= START ========================= */
render();
</script>
</body>

</html>




